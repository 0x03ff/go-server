// Decode the base64-encoded public key
    publicKeyBytes, err := base64.StdEncoding.DecodeString(publicKeyPem)
    if err != nil {
        return "", fmt.Errorf("failed to decode base64 public key: %w", err)
    }


    // Decode the PEM block
    block, rest := pem.Decode(publicKeyBytes)
    if block == nil || len(rest) > 0 {
        return "", errors.New("failed to decode public key PEM")
    }

    log.Printf("Decoded PEM block type: %s", block.Type)

    // Parse the public key
    publicKey, err := x509.ParsePKIXPublicKey(block.Bytes)
    if err != nil {
        return "", fmt.Errorf("failed to parse public key: %w", err)
    }